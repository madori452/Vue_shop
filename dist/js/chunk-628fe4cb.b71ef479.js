(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-628fe4cb"],{"2a64":function(t,e,c){"use strict";c("a6ad")},5727:function(t,e,c){"use strict";c.r(e);var a=c("7a23"),s=c("c215"),l=c.n(s);const o=t=>(Object(a["C"])("data-v-a327b0f6"),t=t(),Object(a["A"])(),t),i=o(()=>Object(a["h"])("div",{class:"container-fluid d-flex align-items-center justify-content-center px-0"},[Object(a["h"])("h4",{class:"en-font"},"CART"),Object(a["h"])("img",{src:l.a,class:"img-fluid banner",alt:"banner"})],-1)),n={class:"container"},r={class:"row my-5"},d={class:"step-line mb-4"},b={class:"col-12 d-flex ps-0 justify-content-center align-items-center en-font mx-auto"},u={class:"circle circle01 col-3"},h=o(()=>Object(a["h"])("p",{class:"step"},"確認訂單資訊",-1)),m=Object(a["i"])('<li class="circle circle01 col-3 offset-sm-1" data-v-a327b0f6><p class="num d-block mx-auto" data-v-a327b0f6>2</p><p class="step" data-v-a327b0f6>建立個人訂單</p></li><li class="circle circle01 col-3 offset-sm-1" data-v-a327b0f6><p class="num d-block mx-auto" data-v-a327b0f6>3</p><p class="step" data-v-a327b0f6>付款完成</p></li>',2),j={key:0,class:"row"},O={key:0,class:"col-lg-6 mx-auto text-center my-5 cart-none bg-white"},p={class:"go-shop mx-auto d-flex justify-content-center align-items-center flex-column"},f=o(()=>Object(a["h"])("h5",{class:"text-primary en-font"},"目前還沒有商品！快去選購吧",-1)),g=o(()=>Object(a["h"])("button",{class:"shop btn btn-primary py-2 px-5 text-white rounded-0"},"選擇商品",-1)),v={key:1,class:"col-xl-5 cart-list-menu bg-white offset-xl-1"},x={class:"px-4"},y=o(()=>Object(a["h"])("p",{class:"h5 en-font mt-5"},"購物清單",-1)),k=o(()=>Object(a["h"])("hr",null,null,-1)),w={class:"table align-middle px-4"},C=o(()=>Object(a["h"])("thead",null,[Object(a["h"])("tr",null,[Object(a["h"])("th"),Object(a["h"])("th",{style:{width:"230px"}},"品名"),Object(a["h"])("th",{style:{width:"110px"}},"數量"),Object(a["h"])("th",{class:"text-end"},"單價")])],-1)),V=["disabled","onClick"],I=o(()=>Object(a["h"])("i",{class:"bi bi-x"},null,-1)),$=[I],_={key:0,class:"text-success"},L={class:"input-group input-group-sm"},z=["onUpdate:modelValue","onChange","disabled"],U={class:"input-group-text"},q={class:"text-end"},S={key:0,class:"text-success"},E=o(()=>Object(a["h"])("td",{colspan:"3",class:"text-end"},"總計",-1)),M={class:"text-end"},P={key:0},A=o(()=>Object(a["h"])("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1)),F={class:"text-end text-success"},J={class:"row w-100 m-0 coupon-code"},G={class:"col-12 d-flex justify-content-end"},R={key:2,class:"form-table-info col-xl-5 px-0"},T={class:"bg-white"},B={class:"row"},D=o(()=>Object(a["h"])("p",{class:"h5 en-font mt-5"},"訂購人資料",-1)),H=o(()=>Object(a["h"])("hr",null,null,-1)),K={class:"mb-3 mt-3"},N=o(()=>Object(a["h"])("label",{for:"email",class:"form-label"},"Email",-1)),Q={class:"mb-3"},W=o(()=>Object(a["h"])("label",{for:"name",class:"form-label"},"姓名",-1)),X={class:"mb-3"},Y=o(()=>Object(a["h"])("label",{for:"tel",class:"form-label"},"電話",-1)),Z={class:"mb-3"},tt=o(()=>Object(a["h"])("label",{for:"address",class:"form-label"},"地址",-1)),et={class:"mb-3"},ct=o(()=>Object(a["h"])("label",{for:"message",class:"form-label"},"留言",-1)),at=o(()=>Object(a["h"])("div",{class:"text-end"},[Object(a["h"])("button",{class:"btn btn-primary w-100 mb-5 py-2 text-white rounded-0"},"送出訂單")],-1));function st(t,e,c,s,l,o){const I=Object(a["I"])("CustomLoading"),st=Object(a["I"])("router-link"),lt=Object(a["I"])("Field"),ot=Object(a["I"])("ErrorMessage"),it=Object(a["I"])("Form");return Object(a["z"])(),Object(a["g"])(a["a"],null,[Object(a["k"])(I,{active:l.isLoading},null,8,["active"]),i,Object(a["h"])("div",n,[Object(a["h"])("div",r,[Object(a["h"])("div",d,[Object(a["h"])("ul",b,[Object(a["h"])("li",u,[Object(a["h"])("p",{class:Object(a["s"])(["num d-block mx-auto",{primary:!0}])},"1"),h]),m])]),l.cart.carts?(Object(a["z"])(),Object(a["g"])("div",j,[0===l.cart.carts.length?(Object(a["z"])(),Object(a["g"])("div",O,[Object(a["h"])("div",p,[f,Object(a["k"])(st,{to:"../user/products"},{default:Object(a["U"])(()=>[g]),_:1})])])):Object(a["f"])("",!0),l.cart.carts.length>=1?(Object(a["z"])(),Object(a["g"])("div",v,[Object(a["h"])("div",x,[y,k,Object(a["h"])("table",w,[C,Object(a["h"])("tbody",null,[l.cart.carts?(Object(a["z"])(!0),Object(a["g"])(a["a"],{key:0},Object(a["G"])(l.cart.carts,e=>(Object(a["z"])(),Object(a["g"])("tr",{key:e.id},[Object(a["h"])("td",null,[Object(a["h"])("button",{type:"button",class:"btn btn-outline-primary btn-sm btn-cancel",disabled:l.status.loadingItem===e.id,onClick:t=>o.removeCartItem(e.id)},$,8,V)]),Object(a["h"])("td",null,[Object(a["j"])(Object(a["L"])(e.product.title)+" ",1),e.coupon?(Object(a["z"])(),Object(a["g"])("div",_," 已套用優惠券 ")):Object(a["f"])("",!0)]),Object(a["h"])("td",null,[Object(a["h"])("div",L,[Object(a["V"])(Object(a["h"])("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":t=>e.qty=t,onChange:t=>o.updateCart(e),disabled:e.id===l.status.loadingItem,style:{width:"30px"}},null,40,z),[[a["P"],e.qty,void 0,{number:!0}]]),Object(a["h"])("span",U,"/"+Object(a["L"])(e.product.unit),1)])]),Object(a["h"])("td",q,[l.cart.final_total!==l.cart.total?(Object(a["z"])(),Object(a["g"])("small",S,"折扣價：")):Object(a["f"])("",!0),Object(a["j"])(" "+Object(a["L"])(t.$filters.currency(e.final_total)),1)])]))),128)):Object(a["f"])("",!0)]),Object(a["h"])("tfoot",null,[Object(a["h"])("tr",null,[E,Object(a["h"])("td",M,Object(a["L"])(t.$filters.currency(l.cart.total)),1)]),l.cart.final_total!==l.cart.total?(Object(a["z"])(),Object(a["g"])("tr",P,[A,Object(a["h"])("td",F,Object(a["L"])(t.$filters.currency(l.cart.final_total)),1)])):Object(a["f"])("",!0)])]),Object(a["h"])("div",J,[Object(a["h"])("div",G,[Object(a["V"])(Object(a["h"])("input",{type:"text",class:"form-control d-inline-block","onUpdate:modelValue":e[0]||(e[0]=t=>l.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[a["P"],l.coupon_code]]),Object(a["h"])("button",{class:"btn btn-outline-secondary d-inline-block ms-2 col-4",type:"button",onClick:e[1]||(e[1]=(...t)=>o.addCouponCode&&o.addCouponCode(...t))}," 套用優惠碼 ")])])])])):Object(a["f"])("",!0),l.cart.carts.length>=1?(Object(a["z"])(),Object(a["g"])("div",R,[Object(a["h"])("div",T,[Object(a["h"])("div",B,[Object(a["k"])(it,{class:"col-md-12 d-flex justify-content-center flex-column form-order",onSubmit:o.createOrder},{default:Object(a["U"])(({errors:t})=>[D,H,Object(a["h"])("div",K,[N,Object(a["k"])(lt,{id:"email",name:"email",type:"email",class:Object(a["s"])(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":e[2]||(e[2]=t=>l.form.user.email=t)},null,8,["class","modelValue"]),Object(a["k"])(ot,{name:"email",class:"invalid-feedback"})]),Object(a["h"])("div",Q,[W,Object(a["k"])(lt,{id:"name",name:"姓名",type:"text",class:Object(a["s"])(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":e[3]||(e[3]=t=>l.form.user.name=t)},null,8,["class","modelValue"]),Object(a["k"])(ot,{name:"姓名",class:"invalid-feedback"})]),Object(a["h"])("div",X,[Y,Object(a["k"])(lt,{id:"tel",name:"電話",type:"tel",class:Object(a["s"])(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:l.form.user.tel,"onUpdate:modelValue":e[4]||(e[4]=t=>l.form.user.tel=t)},null,8,["class","modelValue"]),Object(a["k"])(ot,{name:"電話",class:"invalid-feedback"})]),Object(a["h"])("div",Z,[tt,Object(a["k"])(lt,{id:"address",name:"地址",type:"text",class:Object(a["s"])(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":e[5]||(e[5]=t=>l.form.user.address=t)},null,8,["class","modelValue"]),Object(a["k"])(ot,{name:"地址",class:"invalid-feedback"})]),Object(a["h"])("div",et,[ct,Object(a["V"])(Object(a["h"])("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"2","onUpdate:modelValue":e[6]||(e[6]=t=>l.form.message=t)},null,512),[[a["P"],l.form.message]])]),at]),_:1},8,["onSubmit"])])])])):Object(a["f"])("",!0)])):Object(a["f"])("",!0)])])],64)}var lt={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},status:{loadingItem:""},isLoading:!1,cart:{},coupon_code:""}},inject:["emitter"],methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/cart";this.isLoading=!0,this.$http.get(t).then(t=>{this.cart=t.data.data,this.isLoading=!1})},updateCart(t){const e="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/cart/"+t.id;this.isLoading=!0,this.status.loadingItem=t.id;const c={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:c}).then(t=>{this.getCart(),this.status.loadingItem=""}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/coupon",e={code:this.coupon_code};this.$http.post(t,{data:e}).then(t=>{this.$httpMessageState(t,"加入優惠券"),this.getCart()}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})},removeCartItem(t){const e="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/cart/"+t;this.isLoading=!0,this.status.loadingItem=t,this.$http.delete(e).then(t=>{this.status.loadingItem="",this.emitter.emit("update-qty"),this.$httpMessageState(t,"刪除購物車品項"),this.getCart(),this.isLoading=!1}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})},createOrder(){const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/order",e=this.form;this.$http.post(t,{data:e}).then(t=>{this.orderId=t.data.orderId,this.$router.push("/checkout/"+this.orderId)}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})}},created(){this.getCart()}},ot=(c("2a64"),c("6b0d")),it=c.n(ot);const nt=it()(lt,[["render",st],["__scopeId","data-v-a327b0f6"]]);e["default"]=nt},a6ad:function(t,e,c){},c215:function(t,e,c){t.exports=c.p+"img/banner-cart.3775134b.png"}}]);
//# sourceMappingURL=chunk-628fe4cb.b71ef479.js.map