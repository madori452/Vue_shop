(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7634c380"],{1135:function(t,e,s){"use strict";s.r(e);var i=s("7a23");const a={class:"table mt-4"},o=Object(i["h"])("thead",null,[Object(i["h"])("tr",null,[Object(i["h"])("th",{width:"120"},"分類"),Object(i["h"])("th",null,"產品名稱"),Object(i["h"])("th",{width:"120"},"原價"),Object(i["h"])("th",{width:"120"},"售價"),Object(i["h"])("th",{width:"100"},"是否啟用"),Object(i["h"])("th",{width:"200"},"編輯")])],-1),l={class:"text-right"},c={class:"text-right"},n={key:0,class:"text-success"},d={key:1,class:"text-muted"},r={class:"btn-group"},h=["onClick"],u=["onClick"];function b(t,e,s,b,m,p){const g=Object(i["I"])("Loading"),j=Object(i["I"])("Pagination"),O=Object(i["I"])("ProductModal"),f=Object(i["I"])("DelModal");return Object(i["z"])(),Object(i["g"])(i["a"],null,[Object(i["k"])(g,{active:m.isLoading},null,8,["active"]),Object(i["h"])("button",{onClick:e[0]||(e[0]=t=>p.openModal(!0)),class:"btn btn-primary px-5 rounded-0 text-white mt-2",type:"button"},"新增一個產品"),Object(i["h"])("table",a,[o,(Object(i["z"])(!0),Object(i["g"])(i["a"],null,Object(i["G"])(m.products,e=>(Object(i["z"])(),Object(i["g"])("tbody",{key:e.id},[Object(i["h"])("tr",null,[Object(i["h"])("td",null,Object(i["L"])(e.category),1),Object(i["h"])("td",null,Object(i["L"])(e.title),1),Object(i["h"])("td",l,Object(i["L"])(t.$filters.currency(e.origin_price)),1),Object(i["h"])("td",c,Object(i["L"])(t.$filters.currency(e.price)),1),Object(i["h"])("td",null,[e.is_enabled?(Object(i["z"])(),Object(i["g"])("span",n,"啟用")):(Object(i["z"])(),Object(i["g"])("span",d,"未啟用"))]),Object(i["h"])("td",null,[Object(i["h"])("div",r,[Object(i["h"])("button",{onClick:t=>p.openModal(!1,e),class:"btn btn-outline-primary btn-sm"},"編輯",8,h),Object(i["h"])("button",{onClick:t=>p.opendelModal(e),class:"btn btn-outline-danger btn-sm"},"刪除",8,u)])])])]))),128))]),Object(i["k"])(j,{pages:m.pagination,onEmitPages:p.getProducts},null,8,["pages","onEmitPages"]),Object(i["k"])(O,{ref:"productModal",product:m.tempProduct,onUpdateProduct:p.updateProduct},null,8,["product","onUpdateProduct"]),Object(i["k"])(f,{ref:"delModal",item:m.tempProduct,onDelItem:p.delProduct},null,8,["item","onDelItem"])],64)}const m={class:"modal fade",ref:"modal",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},p={class:"modal-dialog modal-xl",role:"document"},g={class:"modal-content border-0"},j=Object(i["h"])("div",{class:"modal-header bg-dark text-white"},[Object(i["h"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(i["h"])("span",null,"新增產品")]),Object(i["h"])("button",{type:"button",class:"btn-close"})],-1),O={class:"modal-body"},f={class:"row"},_={class:"col-sm-4"},v={class:"mb-3"},y=Object(i["h"])("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),P={class:"mb-3"},w=Object(i["h"])("label",{for:"customFile",class:"form-label"},[Object(i["j"])("或 上傳圖片 "),Object(i["h"])("i",{class:"fas fa-spinner fa-spin"})],-1),k=["src"],x={key:0,class:"mt-5"},L=["onUpdate:modelValue"],M=["onClick"],C={key:0},T={class:"col-sm-8"},V={class:"mb-3"},$=Object(i["h"])("label",{for:"title",class:"form-label"},"標題",-1),z={class:"row gx-2"},U={class:"mb-3 col-md-6"},A=Object(i["h"])("label",{for:"category",class:"form-label"},"分類",-1),D={class:"mb-3 col-md-6"},E=Object(i["h"])("label",{for:"price",class:"form-label"},"單位",-1),I={class:"row gx-2"},B={class:"mb-3 col-md-6"},F=Object(i["h"])("label",{for:"origin_price",class:"form-label"},"原價",-1),S={class:"mb-3 col-md-6"},N=Object(i["h"])("label",{for:"price",class:"form-label"},"售價",-1),R=Object(i["h"])("hr",null,null,-1),q={class:"mb-3"},H=Object(i["h"])("label",{for:"description",class:"form-label"},"產品描述",-1),W={class:"mb-3"},G=Object(i["h"])("label",{for:"content",class:"form-label"},"說明內容",-1),J={class:"mb-3"},Y={class:"form-check"},Q=Object(i["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),K={class:"modal-footer"},X=Object(i["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Z(t,e,s,a,o,l){return Object(i["z"])(),Object(i["g"])("div",m,[Object(i["h"])("div",p,[Object(i["h"])("div",g,[j,Object(i["h"])("div",O,[Object(i["h"])("div",f,[Object(i["h"])("div",_,[Object(i["h"])("div",v,[y,Object(i["V"])(Object(i["h"])("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":e[0]||(e[0]=t=>o.tempProduct.imageUrl=t),placeholder:"請輸入圖片連結"},null,512),[[i["P"],o.tempProduct.imageUrl]])]),Object(i["h"])("div",P,[w,Object(i["h"])("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>l.uploadFile&&l.uploadFile(...t))},null,544)]),Object(i["h"])("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:""},null,8,k),o.tempProduct.images?(Object(i["z"])(),Object(i["g"])("div",x,[(Object(i["z"])(!0),Object(i["g"])(i["a"],null,Object(i["G"])(o.tempProduct.images,(t,e)=>(Object(i["z"])(),Object(i["g"])("div",{class:"mb-3 input-group",key:e},[Object(i["V"])(Object(i["h"])("input",{type:"url",class:"form-control form-control","onUpdate:modelValue":t=>o.tempProduct.images[e]=t,placeholder:"請輸入連結"},null,8,L),[[i["P"],o.tempProduct.images[e]]]),Object(i["h"])("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>o.tempProduct.images.splice(e,1)}," 移除 ",8,M)]))),128)),o.tempProduct.images[o.tempProduct.images.length-1]||!o.tempProduct.images.length?(Object(i["z"])(),Object(i["g"])("div",C,[Object(i["h"])("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=t=>o.tempProduct.images.push(""))}," 新增圖片 ")])):Object(i["f"])("",!0)])):Object(i["f"])("",!0)]),Object(i["h"])("div",T,[Object(i["h"])("div",V,[$,Object(i["V"])(Object(i["h"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[3]||(e[3]=t=>o.tempProduct.title=t),placeholder:"請輸入標題"},null,512),[[i["P"],o.tempProduct.title]])]),Object(i["h"])("div",z,[Object(i["h"])("div",U,[A,Object(i["V"])(Object(i["h"])("input",{type:"text",class:"form-control",id:"category","onUpdate:modelValue":e[4]||(e[4]=t=>o.tempProduct.category=t),placeholder:"請輸入分類"},null,512),[[i["P"],o.tempProduct.category]])]),Object(i["h"])("div",D,[E,Object(i["V"])(Object(i["h"])("input",{type:"text",class:"form-control",id:"unit","onUpdate:modelValue":e[5]||(e[5]=t=>o.tempProduct.unit=t),placeholder:"請輸入單位"},null,512),[[i["P"],o.tempProduct.unit]])])]),Object(i["h"])("div",I,[Object(i["h"])("div",B,[F,Object(i["V"])(Object(i["h"])("input",{type:"number",class:"form-control",id:"origin_price","onUpdate:modelValue":e[6]||(e[6]=t=>o.tempProduct.origin_price=t),placeholder:"請輸入原價"},null,512),[[i["P"],o.tempProduct.origin_price,void 0,{number:!0}]])]),Object(i["h"])("div",S,[N,Object(i["V"])(Object(i["h"])("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":e[7]||(e[7]=t=>o.tempProduct.price=t),placeholder:"請輸入售價"},null,512),[[i["P"],o.tempProduct.price,void 0,{number:!0}]])])]),R,Object(i["h"])("div",q,[H,Object(i["V"])(Object(i["h"])("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[8]||(e[8]=t=>o.tempProduct.description=t),placeholder:"請輸入產品描述"},null,512),[[i["P"],o.tempProduct.description]])]),Object(i["h"])("div",W,[G,Object(i["V"])(Object(i["h"])("textarea",{type:"text",class:"form-control",id:"content","onUpdate:modelValue":e[9]||(e[9]=t=>o.tempProduct.content=t),placeholder:"請輸入產品說明內容"},null,512),[[i["P"],o.tempProduct.content]])]),Object(i["h"])("div",J,[Object(i["h"])("div",Y,[Object(i["V"])(Object(i["h"])("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=t=>o.tempProduct.is_enabled=t),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[i["O"],o.tempProduct.is_enabled]]),Q])])])])]),Object(i["h"])("div",K,[X,Object(i["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=e=>t.$emit("update-product",o.tempProduct))}," 確認 ")])])])],512)}var tt=s("e0ae"),et={mixins:[tt["a"]],props:{product:{type:Object,default(){return{}}}},watch:{product(){this.tempProduct=this.product}},data(){return{modal:{},tempProduct:{}}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0];console.dir(t);const e=new FormData;e.append("file-to-upload",t);const s="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/upload";this.$http.post(s,e).then(t=>{t.data.success&&(this.tempProduct.imageUsrl=t.data.imageUrl)}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})}}},st=s("6b0d"),it=s.n(st);const at=it()(et,[["render",Z]]);var ot=at,lt=s("6ff1"),ct=s("1799"),nt={data(){return{products:[],pagination:{},tempProduct:{},isNew:!1,isLoading:!1}},components:{ProductModal:ot,DelModal:lt["a"],Pagination:ct["a"]},inject:["emitter"],methods:{getProducts(t=1){const e="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/products/?page="+t;this.isLoading=!0,this.$http.get(e).then(t=>{this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})},delProduct(){const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/product/"+this.tempProduct.id;this.$http.delete(t).then(t=>{const e=this.$refs.delModal;e.hideModal(),this.getProducts()}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})},opendelModal(t){this.tempProduct={...t};const e=this.$refs.delModal;e.showModal()},openModal(t,e){this.tempProduct=t?{}:{...e},this.isNew=t;const s=this.$refs.productModal;s.showModal()},updateProduct(t){this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/product",s="post";this.isNew||(e="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/product/"+t.id,s="put");const i=this.$refs.productModal;this.$http[s](e,{data:this.tempProduct}).then(t=>{i.hideModal(),t.data.success?(this.getProducts(),this.emitter.emit("push-message",{style:"success",title:"更新成功"})):this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:t.data.message.join("、")})}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message})})}},created(){this.getProducts()}};const dt=it()(nt,[["render",b]]);e["default"]=dt},1799:function(t,e,s){"use strict";var i=s("7a23");const a={"aria-label":"Page navigation example"},o={class:"pagination justify-content-center"},l=Object(i["h"])("a",{class:"page-link",href:"#","aria-label":"Previous"},[Object(i["h"])("span",{"aria-hidden":"true"},"«")],-1),c=[l],n=["onClick"],d=Object(i["h"])("a",{class:"page-link",href:"#","aria-label":"Next"},[Object(i["h"])("span",{"aria-hidden":"true"},"»")],-1),r=[d];function h(t,e,s,l,d,h){return Object(i["z"])(),Object(i["g"])("nav",a,[Object(i["h"])("ul",o,[Object(i["h"])("li",{class:"page-item",onClick:e[0]||(e[0]=Object(i["W"])(t=>h.updatePage(s.pages.current_page-1),["prevent"]))},c),(Object(i["z"])(!0),Object(i["g"])(i["a"],null,Object(i["G"])(s.pages.total_pages,t=>(Object(i["z"])(),Object(i["g"])("li",{class:Object(i["s"])(["page-item",{active:t===s.pages.current_page}]),key:t},[Object(i["h"])("a",{class:"page-link",href:"#",onClick:Object(i["W"])(e=>h.updatePage(t),["prevent"])},Object(i["L"])(t),9,n)],2))),128)),Object(i["h"])("li",{class:"page-item",onClick:e[1]||(e[1]=Object(i["W"])(t=>h.updatePage(s.pages.current_page+1),["prevent"]))},r)])])}var u={props:["pages","productClass"],emits:["emit-pages"],methods:{updatePage(t){this.$emit("emit-pages",t)}}},b=s("6b0d"),m=s.n(b);const p=m()(u,[["render",h]]);e["a"]=p},"6ff1":function(t,e,s){"use strict";var i=s("7a23");const a={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},o={class:"modal-dialog",role:"document"},l={class:"modal-content border-0"},c={class:"modal-header bg-danger text-white"},n={class:"modal-title"},d=Object(i["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),r={class:"modal-body"},h=Object(i["j"])(" 是否刪除 "),u={class:"text-danger"},b=Object(i["j"])(" (刪除後將無法恢復)。 "),m={class:"modal-footer"},p=Object(i["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function g(t,e,s,g,j,O){return Object(i["z"])(),Object(i["g"])("div",a,[Object(i["h"])("div",o,[Object(i["h"])("div",l,[Object(i["h"])("div",c,[Object(i["h"])("h5",n,[Object(i["h"])("span",null,"刪除 "+Object(i["L"])(s.item.title),1)]),d]),Object(i["h"])("div",r,[h,Object(i["h"])("strong",u,Object(i["L"])(s.item.title),1),b]),Object(i["h"])("div",m,[p,Object(i["h"])("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-item"))},"確認刪除 ")])])])],512)}var j=s("e0ae"),O={props:{item:{}},data(){return{modal:""}},mixins:[j["a"]]},f=s("6b0d"),_=s.n(f);const v=_()(O,[["render",g]]);e["a"]=v},"7c2b":function(t,e,s){
/*!
  * Bootstrap modal.js v5.2.0 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
(function(e,i){t.exports=i(s("aa53"),s("6a95"),s("848f"),s("ba05"),s("302d"),s("1494"),s("5470"),s("0f28"))})(0,(function(t,e,s,i,a,o,l,c){"use strict";const n=t=>t&&"object"===typeof t&&"default"in t?t:{default:t},d=n(e),r=n(s),h=n(i),u=n(a),b=n(o),m=n(l),p="modal",g="bs.modal",j="."+g,O=".data-api",f="Escape",_="hide"+j,v="hidePrevented"+j,y="hidden"+j,P="show"+j,w="shown"+j,k="resize"+j,x="mousedown.dismiss"+j,L="keydown.dismiss"+j,M=`click${j}${O}`,C="modal-open",T="fade",V="show",$="modal-static",z=".modal.show",U=".modal-dialog",A=".modal-body",D='[data-bs-toggle="modal"]',E={backdrop:!0,focus:!0,keyboard:!0},I={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class B extends u.default{constructor(t,e){super(t,e),this._dialog=r.default.findOne(U,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new h.default,this._addEventListeners()}static get Default(){return E}static get DefaultType(){return I}static get NAME(){return p}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||this._isTransitioning)return;const e=d.default.trigger(this._element,P,{relatedTarget:t});e.defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(C),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){if(!this._isShown||this._isTransitioning)return;const t=d.default.trigger(this._element,_);t.defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(V),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const t of[window,this._dialog])d.default.off(t,j);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new b.default({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new m.default({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=r.default.findOne(A,this._dialog);s&&(s.scrollTop=0),t.reflow(this._element),this._element.classList.add(V);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,d.default.trigger(this._element,w,{relatedTarget:e})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){d.default.on(this._element,L,t=>{if(t.key===f)return this._config.keyboard?(t.preventDefault(),void this.hide()):void this._triggerBackdropTransition()}),d.default.on(window,k,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),d.default.on(this._element,x,t=>{t.target===t.currentTarget&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(C),this._resetAdjustments(),this._scrollBar.reset(),d.default.trigger(this._element,y)})}_isAnimated(){return this._element.classList.contains(T)}_triggerBackdropTransition(){const t=d.default.trigger(this._element,v);if(t.defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._element.style.overflowY;"hidden"===s||this._element.classList.contains($)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add($),this._queueCallback(()=>{this._element.classList.remove($),this._queueCallback(()=>{this._element.style.overflowY=s},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),i=s>0;if(i&&!e){const e=t.isRTL()?"paddingLeft":"paddingRight";this._element.style[e]=s+"px"}if(!i&&e){const e=t.isRTL()?"paddingRight":"paddingLeft";this._element.style[e]=s+"px"}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const s=B.getOrCreateInstance(this,t);if("string"===typeof t){if("undefined"===typeof s[t])throw new TypeError(`No method named "${t}"`);s[t](e)}}))}}return d.default.on(document,M,D,(function(e){const s=t.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),d.default.one(s,P,e=>{e.defaultPrevented||d.default.one(s,y,()=>{t.isVisible(this)&&this.focus()})});const i=r.default.findOne(z);i&&B.getInstance(i).hide();const a=B.getOrCreateInstance(s);a.toggle(this)})),c.enableDismissTrigger(B),t.defineJQueryPlugin(B),B}))},e0ae:function(t,e,s){"use strict";var i=s("7c2b"),a=s.n(i);e["a"]={methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new a.a(this.$refs.modal)}}}}]);
//# sourceMappingURL=chunk-7634c380.170f9901.js.map